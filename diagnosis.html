<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>2025 神工校内マップ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
        <style>
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
    </style>
    <script type="importmap">
        {
          "imports": {
            "@google/generative-ai": "https://esm.run/@google/generative-ai"
          }
        }
    </script>
</head>
<body class="rn">
    <header>
        <h2>NHK杯全国高校放送コンテスト<br>神奈川県大会</h2>
    </header>
    <h2>AIがあなたに向いている産業教育系専門学科をお調べします！！</h2>
    <div id="navigation-bar" class="for-sp">
        <ul>
            <li id="bar-blue"><a href="index.html">フロアマップ</a></li>
            <li id="bar-red"><a href="sakuin.html">索引</a></li>
            <li id="bar-red"><a href="diagnosis.html">診断</a></li>
            <li id="bar-red"><a href="https://sites.google.com/view/kanakousiken/">集まれ放送委員会</a></li>
            <li id="bar-yellow"><a href="https://www.nhk.or.jp/event/n-con/">NコンWEB</a></li>
        </ul>
    </div>
    
    <form id="questionForm">
        <!-- 質問ページ -->
        <div class="page active" id="page1">
            <div class="question-set">
                <p>得意なことは？</p>
                <a href="#" class="button" onclick="selectOption('question1', 'A')">屋外で体を動かす</a><br>
                <a href="#" class="button" onclick="selectOption('question1', 'B')">机に向かって集中する</a><br>
                <a href="#" class="button" onclick="selectOption('question1', 'C')">手先を使った細かな作業</a><br>
                <a href="#" class="button" onclick="selectOption('question1', 'D')">人とコミュニケーションを取る</a><br>
            </div>
            <div style="text-align: right;">
                <!--<a href="#" class="button" onclick="skipall()">特性診断をスキップ</a>-->
                <a href="#" class="button" onclick="skipPage()">この質問をスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <div class="page" id="page2">
            <div class="question-set">
                <p>どんな環境が好き？</p>
                <a href="#" class="button" onclick="selectOption('question2', 'A')">自然に囲まれた環境</a><br>
                <a href="#" class="button" onclick="selectOption('question2', 'B')">海や水辺の環境</a><br>
                <a href="#" class="button" onclick="selectOption('question2', 'C')">街中や都会の環境</a><br>
            </div>
            <div style="text-align: right;">
                <a href="#" class="button" onclick="prevPage()">前へ</a>
                <a href="#" class="button" onclick="submitForm()">結果までスキップ</a>
                <a href="#" class="button" onclick="skipPage()">この質問をスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <div class="page" id="page3">
            <div class="question-set">
                <p>好きな教科は何？</p>
                <a href="#" class="button" onclick="selectOption('question3', 'A')">国語</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'B')">数学</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'C')">英語</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'D')">理科</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'E')">社会</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'F')">保健・体育</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'G')">技術・家庭</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'H')">美術</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'I')">音楽</a><br>
                <a href="#" class="button" onclick="selectOption('question3', 'J')">道徳</a><br>
            </div>
            <div style="text-align: right;">
                <a href="#" class="button" onclick="prevPage()">前へ</a>
                <a href="#" class="button" onclick="submitForm()">結果までスキップ</a>
                <a href="#" class="button" onclick="skipPage()">この質問をスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <div class="page" id="page4">
            <div class="question-set">
                <p>達成感を感じる時はいつ？</p>
                <a href="#" class="button" onclick="selectOption('question4', 'A')">自分の育てたものが成長した時</a><br>
                <a href="#" class="button" onclick="selectOption('question4', 'B')">目標を達成した時</a><br>
                <a href="#" class="button" onclick="selectOption('question4', 'C')">自分の手で何かを作り上げた時</a><br>
                <a href="#" class="button" onclick="selectOption('question4', 'D')">誰かの役に立てた時</a><br>
                <a href="#" class="button" onclick="selectOption('question4', 'E')">仲間と困難を乗り越えた時</a><br>
                <a href="#" class="button" onclick="selectOption('question4', 'F')">自由になった時</a><br>
            </div>
            <div style="text-align: right;">
                <a href="#" class="button" onclick="prevPage()">前へ</a>
                <a href="#" class="button" onclick="submitForm()">結果までスキップ</a>
                <a href="#" class="button" onclick="skipPage()">この質問をスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <div class="page" id="page5">
            <div class="question-set">
                <p>どんな自分になりたい？</p>
                <a href="#" class="button" onclick="selectOption('question5', 'A')">社会インフラを支える</a><br>
                <a href="#" class="button" onclick="selectOption('question5', 'B')">人に直接かかわる</a><br>
                <a href="#" class="button" onclick="selectOption('question5', 'C')">植物や動物にかかわる</a><br>
                <a href="#" class="button" onclick="selectOption('question5', 'D')">幅広い分野で活躍する</a><br>
            </div>
            <div style="text-align: right;">
                <a href="#" class="button" onclick="prevPage()">前へ</a>
                <a href="#" class="button" onclick="submitForm()">結果までスキップ</a>
                <a href="#" class="button" onclick="skipPage()">この質問をスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <div class="page" id="page6">
            <div class="question-set">
                <p>将来どんなことがしたい？</p>
                <a href="#" class="button" onclick="selectOption('question6', 'A'),submitForm()">ビジネスの場でデータや人と関わりたい</a><br>
                <a href="#" class="button" onclick="selectOption('question6', 'B'),submitForm()">ものづくりの現場に関わりたい</a><br>
                <a href="#" class="button" onclick="selectOption('question6', 'C'),submitForm()">人の健康を守りたい</a><br>
                <a href="#" class="button" onclick="selectOption('question6', 'D'),submitForm()">人をしあわせにしたい</a><br>
                <a href="#" class="button" onclick="selectOption('question6', 'E'),submitForm()">海や船に関わりたい</a><br>
            </div>
            <div style="text-align: right;">
                <a href="#" class="button" onclick="prevPage()">前へ</a>
                <a href="#" class="button" onclick="submitForm()">結果までスキップ</a>
            </div>
            <br><br><br><br><br><br><br>
        </div>

        <!-- 結果表示ページ -->
        <div class="page" id="page7">
            <h2>診断結果:</h2>
            <div id="result">
                <p>診断中です・・・</p>
                <!-- 結果がここに表示される -->
            </div>
            <br><br><br><br><br><br><br>
        </div>
    </form>
    <footer>
        <p><small>AI診断 111期生製作 v1.1</small></p>
        <br><br><br><br>
    </footer>
    
    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        let currentPage = 1;
        const totalPages = 7;
        const selectedOptions = {};
        const questions = {
            question1: { text: '得意なことは？', options: { A: '屋外で体を動かす', B: '机に向かって集中する', C: '手先を使った細かな作業', D: '人とコミュニケーションを取る' } },
            question2: { text: 'どんな環境が好き？', options: { A: '自然に囲まれた環境', B: '海や水辺の環境', C: '街中や都会の環境' } },
            question3: { text: '好きな教科は何？', options: { A: '国語', B: '数学', C: '英語', D: '理科', E: '社会', F: '保健・体育', G: '技術・家庭', H: '美術', I: '音楽', J: '道徳' } },
            question4: { text: '達成感を感じる時はいつ？', options: { A: '自分の育てたものが成長した時', B: '目標を達成した時', C: '自分の手で何かを作り上げた時', D: '誰かの役に立てた時', E: '仲間と困難を乗り越えた時', F: '自由になった時' } },
            question5: { text: 'どんな自分になりたい？', options: { A: '社会インフラを支える', B: '人に直接かかわる', C: '植物や動物にかかわる', D: '幅広い分野で活躍する' } },
            question6: { text: '将来どんなことがしたい？', options: { A: 'ビジネスの場でデータや人と関わりたい', B: 'ものづくりの現場に関わりたい', C: '人の健康を守りたい', D: '人をしあわせにしたい', E: '海や船に関わりたい' } }
        };

        //ページを切り替える関数
        function showPage(page) {
            for (let i = 1; i <= totalPages; i++) {
                document.getElementById(`page${i}`).classList.toggle('active', i === page);
            }
        }

        //質問に回答した時の処理
        window.selectOption = function selectOption(question, value) {
            // 選択した回答を保存
            selectedOptions[question] = value;
            console.log("Updated selectedOptions:", selectedOptions);

            if (currentPage < totalPages) {
                currentPage++;
                showPage(currentPage);
            } else {
                //submitForm();
            }
        }

        window.submitForm = async function submitForm() {
            // フォーム送信処理（例: コンソール出力で確認）
            console.log("Form submitted with data:", selectedOptions);
            currentPage = totalPages;
            showPage(currentPage);

            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>診断中です...</p>';

            // プロンプト生成関数
            window.generatePrompt = function generatePrompt(selectedOptions) {
                if (!selectedOptions || typeof selectedOptions !== 'object' || Object.keys(selectedOptions).length === 0) {
                    throw new Error("selectedOptions is not a valid object");
                }

                // プロンプトのベース
                let prompt = `
                    今から送る診断の選択肢と選択内容から、そのユーザー（中学生）に合う高校の産業教育系専門学科を回答してください。回答は大文字半角アルファベット1文字のみで行います。産業教育系専門学科の種類については以下の通りです。

                    A:農業系
                    農業学習は、実験や実習を通して日々「生命」に向き合い、自然を肌で感じられる学習です。自らの興味・関心や将来の夢に合った学科を選び、3年間で基礎的な知識と技術、地域課題に自ら取り組む力を身につけます。
                    農業系は、植物の栽培、動物の飼育、食品製造・流通、生活環境などの分野を学ぶ学科があります。

                    B:工業系
                    「ものづくり」の現場で必要とされる知識や技術・技能などを身につけ、工業と社会の発展に寄与することができる新たな時代のものづくり産業を支える実践的な技術・技能を併せ持った技術者を育成します。
                    工業系は、機械、電気、建設、化学、デザインに関する学科のほか、工業を総合的に学ぶ総合技術科があります。

                    C:商業系
                    ものを生産する人とそれを消費する人とをつなぐ流通をはじめ、マーケティング、簿記、情報処理など様々な業種や職種で役立つ学びを通して、ビジネスで必要となる実践的な力を身につけ、将来の活躍の場を広げます。
                    商業系は、国際化、情報化に対応したビジネス活動について広く学べる総合ビジネス科を設置しています。

                    D:水産系
                    「海・船・魚」を学習素材として、水産業に関することに加え、その生産現場である海洋についての専門的な知識と技術を実践的に学び、各種資格取得を通じ、海のスペシャリストを育てる教育をしています。
                    水産系学科は、海洋科学高校1校にのみ設置されており、航海・機関、漁業、水産食品、情報通信、生物環境などの分野の学びがあります。
                    また、海洋科学高校には、県内唯一の「専攻科」が設置されており、大学や専門学校と同様に、さらに専門性を深めるために進学することができます。専攻科では、航海・機関・無線の各難関国家資格の取得を目標とし、修了後は、大型船の船長・機関長・通信長のほか、海上保安庁、水産庁、航空局等の国家公務員として活躍しています。

                    E:家庭系
                    専門家庭系学科では、衣食住・保育などの生活産業分野のスペシャリストを目指して、人間が生活するために必要な専門的な知識と技術を、科学的な視点から総合的・体験的に学習します。
                    平成31年度から吉田島高校に「生活科学科」が設置され、2年次からヒューマンサービスコースと食健康コースを選んで学ぶことができます。

                    F:看護系
                    人々の命を守り、育むための学びから人としての生き方を考えます。患者さんや医師、看護師などと関わる臨地実習は、人としての生き方を深く考えさせられます。
                    看護系学科は、二俣川看護福祉高校1校にのみ設置されており、看護の心を育てながら、看護系大学等への進学を目ざしています。

                    I:福祉系
                    子どもから高齢者まで、また、障害のあるなしに関わらず、すべての人が「しあわせ」な日常生活を送れることについて考えることが、「ふくし」を学ぶということです。
                    福祉系学科では、社会福祉、介護技術などの実習をとおして総合的・体験的に学び、介護職員初任者研修の修了や介護福祉士の受験資格の取得なども目ざしています。

                    J:総合産業系
                    新たな産業の創出や科学技術の進展に主体的にかかわる創造的な人材の育成を目ざし、社会の変化に柔軟に対応する、産業を総合的に学ぶ専門学科です。
                    総合産業科は、神奈川総合産業高校1校にのみ設置されており、工学、情報、環境バイオ、科学、リベラルアーツなどの分野の学びがあります。

                    以上の8つ(A~J)のアルファベットから1つのみ選んで回答してください。
                    以下は、ユーザーの選択肢と選択内容です。
                `;

                for (const [questionId, answer] of Object.entries(selectedOptions)) {
                    const question = questions[questionId];
                    if (question) {
                        prompt += `質問: ${question.text}\n`;
                        prompt += `選択肢:\n`;
                        for (const [optionKey, optionText] of Object.entries(question.options)) {
                            prompt += `${optionKey}: ${optionText}\n`;
                        }
                        prompt += `回答: ${answer} - ${question.options[answer]}\n\n`;
                    }
                }

                return prompt;
            };
            
            const prompt = generatePrompt(selectedOptions);

            try {
                const model = new GoogleGenerativeAI("AIzaSyB2PojzyoDO5-4cJkGwM89DxWNPSp_YmhI");
                const aiModel = await model.getGenerativeModel({ model: "gemini-1.5-flash" });
                const response = await aiModel.generateContent(prompt);

                // Geminiから返ってきた結果を取得し、表示関数に渡す
                const result = response.response?.text()?.trim();  // Geminiのアルファベット1文字を取得
                handleGeminiResponse(result);  // 結果を処理して表示

                //const resultText = response.response?.text() || "結果が取得できませんでした。";
                //resultDiv.innerHTML = `<p>${resultText}</p>`;
            } catch (error) {
                console.error("Error generating AI response:", error);
                resultDiv.innerHTML = '<p>エラーが発生しました。再試行してください。</p>';
            }
        }

        //ページをスキップする時の処理
        window.skipPage = function skipPage() {
            if (currentPage < totalPages) {
                currentPage++;
                showPage(currentPage);
            }
        }

        //前のページへ戻る時の処理
        window.prevPage = function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                showPage(currentPage);
            }
        }

        //診断オールスキップ(作ってない)
        function skipall() {

        }

        function handleGeminiResponse(result) {
            if (!result) {
                console.error('無効な結果:', result);
                alert('予期しないエラーが発生しました。もう一度お試しください。');
                return;
            }

            // 画像ファイル名を生成（例: "A.png"）
            const imageUrl = `keitou/${result}.png`;

            // 結果を表示するHTML要素を取得
            const resultDiv = document.getElementById('result');

            // 文字
            resultDiv.innerHTML = "<p>あなたに向いている産業教育系専門学科は・・・</p>"
            
            // 画像を表示
            resultDiv.innerHTML += `<img class="images" src="${imageUrl}" alt="診断結果の画像">`;

            // 画像表示後のテキストやメッセージを追加
            resultDiv.innerHTML += `${resultMapping[result].text}`;
        }

        const resultMapping = {
            A: {
                text: '<h2>農業系</h2><p>農業学習は、実験や実習を通して日々「生命」に向き合い、自然を肌で感じられる学習です。自らの興味・関心や将来の夢に合った学科を選び、3年間で基礎的な知識と技術、地域課題に自ら取り組む力を身につけます。<br>農業系は、植物の栽培、動物の飼育、食品製造・流通、生活環境などの分野を学ぶ学科があります。</p>',
            },
            B: {
                text: '<h2>工業系</h2><p>「ものづくり」の現場で必要とされる知識や技術・技能などを身につけ、工業と社会の発展に寄与することができる新たな時代のものづくり産業を支える実践的な技術・技能を併せ持った技術者を育成します。<br>工業系は、機械、電気、建設、化学、デザインに関する学科のほか、工業を総合的に学ぶ総合技術科があります。</p>',
            },
            C: {
                text: '<h2>商業系</h2><p>ものを生産する人とそれを消費する人とをつなぐ流通をはじめ、マーケティング、簿記、情報処理など様々な業種や職種で役立つ学びを通して、ビジネスで必要となる実践的な力を身につけ、将来の活躍の場を広げます。<br>商業系は、国際化、情報化に対応したビジネス活動について広く学べる総合ビジネス科を設置しています。</p>',
            },
            D: {
                text: '<h2>水産系</h2><p>「海・船・魚」を学習素材として、水産業に関することに加え、その生産現場である海洋についての専門的な知識と技術を実践的に学び、各種資格取得を通じ、海のスペシャリストを育てる教育をしています。<br>水産系学科は、海洋科学高校1校にのみ設置されており、航海・機関、漁業、水産食品、情報通信、生物環境などの分野の学びがあります。<br>また、海洋科学高校には、県内唯一の「専攻科」が設置されており、大学や専門学校と同様に、さらに専門性を深めるために進学することができます。専攻科では、航海・機関・無線の各難関国家資格の取得を目標とし、修了後は、大型船の船長・機関長・通信長のほか、海上保安庁、水産庁、航空局等の国家公務員として活躍しています。</p>',
            },
            E: {
                text: '<h2>家庭系</h2><p>専門家庭系学科では、衣食住・保育などの生活産業分野のスペシャリストを目指して、人間が生活するために必要な専門的な知識と技術を、科学的な視点から総合的・体験的に学習します。<br>平成31年度から吉田島高校に「生活科学科」が設置され、2年次からヒューマンサービスコースと食健康コースを選んで学ぶことができます。</p>',
            },
            F: {
                text: '<h2>看護系</h2><p>人々の命を守り、育むための学びから人としての生き方を考えます。患者さんや医師、看護師などと関わる臨地実習は、人としての生き方を深く考えさせられます。<br>看護系学科は、二俣川看護福祉高校1校にのみ設置されており、看護の心を育てながら、看護系大学等への進学を目ざしています。</p>',
            },
            I: {
                text: '<h2>福祉系</h2><p>子どもから高齢者まで、また、障害のあるなしに関わらず、すべての人が「しあわせ」な日常生活を送れることについて考えることが、「ふくし」を学ぶということです。<br>福祉系学科では、社会福祉、介護技術などの実習をとおして総合的・体験的に学び、介護職員初任者研修の修了や介護福祉士の受験資格の取得なども目ざしています。</p>',
            },
            J: {
                text: '<h2>総合産業系</h2>新たな産業の創出や科学技術の進展に主体的にかかわる創造的な人材の育成を目ざし、社会の変化に柔軟に対応する、産業を総合的に学ぶ専門学科です。<br>総合産業科は、神奈川総合産業高校1校にのみ設置されており、工学、情報、環境バイオ、科学、リベラルアーツなどの分野の学びがあります。</p>',
            },
        };
    </script>
</body>
</html>
